FROM apache/airflow:3.0.0-python3.11

USER airflow

RUN mkdir -p /opt/airflow/dag_generated_configs/

# REMOVE airflow_local_settings to avoid import error
RUN rm -f /opt/airflow/config/airflow_local_settings.py || true

RUN pip install --no-cache-dir \
    apache-airflow-providers-openlineage==2.3.0 \
    openmetadata-ingestion==1.7.1.1 \
    openmetadata-managed-apis==1.7.1.1 \
    pyarrow>=14.0.1

EXPOSE 8080
