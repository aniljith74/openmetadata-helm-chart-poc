FROM apache/airflow:2.10.5-python3.11 

# Install required Python packages
RUN pip install --no-cache-dir \
    "apache-airflow-providers-fab==1.1.0" \
    "apache-airflow-providers-openlineage==2.2.0" \
    "openmetadata-ingestion[airflow]==1.7.2.1" \
    "openmetadata-managed-apis==1.7.2.1" \
    "pyarrow==12.0.1"


COPY ./plugins /opt/airflow/plugins
COPY ./dags /opt/airflow/dags

# Set environment variables
ENV AIRFLOW__CORE__LOAD_EXAMPLES=False
ENV AIRFLOW__OPENLINEAGE__ENABLED=True

EXPOSE 8080

USER airflow